<!--
 * @Author: hft
 * @Date: 2021-09-10 15:17:22
 * @LastEditTime: 2021-09-10 17:14:56
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \myblog_local\docs\react\0.2React-hooks.md
-->
## 一.useState
#### 1. 定义：
react自带的一个hook函数，它的作用是用来声明状态变量。
#### 2. 用法
* 声明
```javascript
//数组结构
const [ count , setCount ] = useState(0);
// 不写成数组解构
// let _useState = userState(0)
// let count = _useState[0]
// let setCount = _useState[1]
```
* 读取
```javascript
<p>You clicked {count} times</p>
```  
* 使用
```javascript
<button onClick={()=>{setCount(count+1)}}>click me</button>
```
#### 3.多状态声明注意事项
在使用useState的时候只赋了初始值，并没有绑定任何的key，`React是根据useState出现的顺序来确定的`
`React Hooks`不能出现在条件判断语句中，因为它必须有完全一样的渲染顺序。

## 二.useEffect
#### 1. 定义：
useEffect代替常用生命周期函数,代表第一次组件渲染和每次组件更新都会执行这个函数
#### 2.实现componentDidMonut和componentDidUpdate例子
 ```javascript
import React, { useState , useEffect } from 'react';
function Example(){
    const [ count , setCount ] = useState(0);
    //---关键代码---------start-------
    useEffect(()=>{
        console.log(`useEffect=>You clicked ${count} times`)
    })
    //---关键代码---------end-------

    return (
        <div>
            <p>You clicked {count} times</p>
            <button onClick={()=>{setCount(count+1)}}>click me</button>
        </div>
    )
}
export default Example;
```
解析：首先，我们生命了一个状态变量count,将它的初始值设为0，然后我们告诉react，我们的这个组件有一个副作用。给useEffecthook传了一个匿名函数，这个匿名函数就是我们的副作用。在这里我们打印了一句话，当然你也可以手动的去修改一个DOM元素。当React要渲染组件时，它会记住用到的副作用，然后执行一次。等Reat更新了State状态时，它再一词执行定义的副作用函数。

#### 3. 实现 componentWillUnmount生命周期函数例子

```javascript
 function Example(){
    const [ count , setCount ] = useState(0);

    useEffect(()=>{
        console.log(`useEffect=>You clicked ${count} times`)

        return ()=>{
            console.log('====================')
        }
    },[count])

    return (
        <div>
            <p>You clicked {count} times</p>
            <button onClick={()=>{setCount(count+1)}}>click me</button>

            <Router>
                <ul>
                    <li> <Link to="/">首页</Link> </li>
                    <li><Link to="/list/">列表</Link> </li>
                </ul>
                <Route path="/" exact component={Index} />
                <Route path="/list/" component={List} />
            </Router>
        </div>
    )
}
```
补充：`useEffect`的第二个参数，它是一个数组，数组中可以写入很多状态对应的变量，意思是当状态值发生变化时，才进行解绑

#### 4. 注意点
* React首次渲染和之后的每次渲染都会调用一遍useEffect函数，而之前我们要用两个生命周期函数分别表示首次渲染(componentDidMonut)和更新导致的重新渲染(componentDidUpdate)。

* useEffect中定义的函数的执行不会阻碍浏览器更新视图，也就是说这些函数时异步执行的，而componentDidMonut和componentDidUpdate中的代码都是同步执行的。

## 三.useContext
#### 1.定义：
跨越组件层级直接传递变量，实现共享。作用就是对它所包含的组件树提供全局共享数据的一种技术。

需要注意的是`useContext`和`redux`的作用是不同的，一个解决的是组件之间值传递的问题，一个是应用中统一管理状态的问题，但通过和`useReducer`的配合使用，可以实现类似`Redux`的作用。
#### 2.例子

`index.js`

```javascript
import React from 'react';
import ReactDOM from 'react-dom';
import Example from './Example4'
ReactDOM.render(<Example />, document.getElementById('root'));
```

`Example4.js`

```javascript

import React, { useState , createContext，useContext  } from 'react';
//===关键代码
const CountContext = createContext()

function Example4(){
    const [ count , setCount ] = useState(0);
    function Counter(){
        const count = useContext(CountContext)  //一句话就可以得到count
        return (<h2>{count}</h2>)
    }

    return (
        <div>
            <p>You clicked {count} times</p>
            <button onClick={()=>{setCount(count+1)}}>click me</button>
            {/*======关键代码 */}
            <CountContext.Provider value={count}>
            <Counter />
            </CountContext.Provider>
        </div>
    )
}
export default Example4;
```
解析：这段代码就相当于把count变量允许跨层级实现传递和使用了（也就是实现了上下文），当父组件的count变量发生变化时，子组件也会发生变化。
